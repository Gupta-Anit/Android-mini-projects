AutoSettings Design Doc

----
20081101 Goal

Goal:
- a simple replacement to Locale that actually works for _me_.

Locale pros & cons:
- Pros: it's free and it's already there.
- Cons: it should be in the platform, not a separate app.
- Cons: non-standard UI for tabs, deletion and time picker.
- Cons: does many things I don't care yet doesn't do stuff I need.

Non-goal:
- complete feature set of Locale, most of which is not useful to me.


Desired Features (rating number: 1=important to me, 2=less important, 3=useless):
- Location triggers:
    [1] cell-id (coarse loc) vs [2] gps (fine loc), made explicit + update rate.
- Time trigger:
    [1] start/end.
- Date trigger:
    [2] week-of-day
- Settings:
    [1] silent (what power>sound off does)
    [1] ring volume
    [1] vibrate
    [1] brightness
    [2] wifi on/off

For each trigger type (location, time, date), users create instances of
these triggers (i.e. home via cell id, home via gps, night time, week-end).

Triggers have an implicit "next event" timestamp. E.g. for a timer, it's the end
of the timer, for day it's 24 hours and for cell/gps it's the update rate.

A profile is composed of:
- a list of 0 or more trigger instances (add, edit, delete)
- a list of settings to set (add, edit, delete)
- trigger mode: or (any) or and (all)
- activated flag
- exclusive flag: only one flag can be exclusive and thus only this one is
  activated. This is for manual activation.

Profile list:
- profile can only be activated if it has 1 or more settings.
- profile list: add, edit, delete, up, down
- when more than one profile works, apply in the profile order.
- when marked as exclusive, gray all other profiles

There's a list of profiles, with a "default" one (cannot be deleted).
Another default profile should be "silent".

Implementation:
- list of triggers { id, type, user-name, *value, curr-value, value-ts }
- list of settings { id, type, *proc }
- list of profiles { id, user-name, list trigger-id, list settings-id, activated }
- global: exclusive profile-id

- check service:
    - for all triggers, update if value too old
    - compute next check timestamp
    - check profiles, if match, apply settings
    - alarm/sleep till next check ts

----
20090120 Misc Ideas/suggestions

- conditions: time range and/or cellid/gps (+rate check)
- profile group of setting with same condition) vs (condition per setting).
- toggles: led, gps, cellid, wifi, 2g/3g
- levels: media/ringer volumes, brightness
- settings for weekends vs weekdays or weekly
- home icons for profiles

----
20091024 User feedback

A summary of user requested feedback, suggestions, improvements:

- AM/PM versus 24h option
+ toggle 3g/2g => control APNdroid [done]
x toggle auto-sync => can't do in SDK
- profile based on incoming call contact
    - e.g. let it ring when contact X, Y or Z is calling you. Needs whitelist.
+ control notification volume [done]
+ toggle bluetooth => [done in 2.0, not 1.6]
- backup/restore settings from sdcard and/or email
- icon bar for profile list (+/-)
- control calendar notification
- display notification of profile change
- calendar integration: change setting during a meeting
- Hero: brightness not working if AutoBrightness on
- Droid: brightness not working if AutoBrightness on
- MyTouch/DRC92: brightness works up but not down (sometimes / can't repro)
- vibrate notification not turned off (e.g. email/gmail notif vibrate)
- UI for volume: 10% increments via drop-down or radios
- media volume
- control based on given days
- Don't switch Airplane during talk. Suggest: notif to let user to it later.

----
20091207 Steps to add a new setting

1- SettingsHelper: add a canControlXyz()
2- SettingsHelper: add a changeXyz(boolean enabled)
3- profiles.Columns: add ACTION_xyz
4- actions.TimedActionUtils: add ACTION_xyz in computeActions()
5- app.AutoReceiver: add ACTION_xyz in performAction()
6- actions.EditActionUI: add private PrefToggle, using in onCreate, onPause.
7- layout/edit_action & layout/land/more_actions: add R.id.xyzButton
8- values-*/strings.xml: add R.string.timedaction_xyz_on/off, R.string.editaction_xyz
